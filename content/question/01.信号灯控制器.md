---
title: "信号灯控制器"
date: 2021-03-02T15:05:24+08:00
keywords: ''
description: ''
tags: []
categories: ['Question']
draft: true
---

## 题目 

信号灯控制器  
用 React 实现一个信号灯（交通灯）控制器，要求：  
1. 默认情况下，  
  1.1. 红灯亮20秒，并且最后5秒闪烁  
  1.2. 绿灯亮20秒，并且最后5秒闪烁  
  1.3. 黄灯亮10秒  
  1.4. 次序为 红-绿-黄-红-绿-黄  
2. 灯的个数、颜色、持续时间、闪烁时间、灯光次序都可配置，如：  
   lights=[{color: '#fff', duration: 10000, twinkleDuration: 5000}, ... ]

## 参考 

```javascript
import React from 'react'
import ReactDOM from 'react-dom'
class TrafficLightItem extends React.Component {
  
}
```

## 一步一步来

版本1：实现一个简单的信号灯切换

```javascript
(function () {
  const start = () => {
    setTimeout(() => {
      console.log("红灯亮.");
      setTimeout(() => {
        console.log("绿灯亮.");
        setTimeout(() => {
          console.log("黄灯亮.");
          start();
        }, 1 * 1000);
      }, 2 * 1000);
    }, 3 * 1000);
  };
  start();
})();
```

版本2：将信号灯分离出来

```javascript
(function () {
  const LIGHTS = ["红灯", "绿灯", "黄灯"];

  const start = (lights = [], count = 0) => {
    let length = lights.length;

    return setTimeout(() => {
      console.log(`${lights[count % length]}亮`);
      count++;
      start(lights, count);
    }, 1000);
  };

  start(LIGHTS);
})();
```

版本3：将信号灯持续时间分离出来

```javascript
(function () {
  const LIGHTS = [
    ["红灯", 3000],
    ["绿灯", 2000],
    ["黄灯", 1000],
  ];

  const start = (lights = [], count = 0) => {
    let length = lights.length;

    return function start() {
      const [light, time] = lights[count % length];

      return setTimeout(() => {
        console.log(`${light}亮`);
        count++;
        start();
      }, time);
    };
  };

  start(LIGHTS)();
})();
```

版本4：添加函数处理器

```javascript
(function () {
  const LIGHTS = [
    ["红灯", 3000],
    ["绿灯", 2000],
    ["黄灯", 1000],
  ];

  const handler = (light, time) => {
    console.log(`${light}亮${time}毫秒`);
  };

  const start = (lights = [], handler, count = 0) => {
    let length = lights.length;

    return function start() {
      const [light, time] = lights[count % length];

      return setTimeout(() => {
        console.log(`${light}亮`);
        handler && handler(light, time);
        count++;
        start();
      }, time);
    };
  };

  start(LIGHTS,handler)();
})();
```

版本5：添加单独函数处理器

```javascript
(function () {
  const LIGHTS = [
    [
      "红灯",
      3000,
      function () {
        console.log(...arguments);
      },
    ],
    [
      "绿灯",
      2000,
      function () {
        console.log("green");
      },
    ],
    [
      "黄灯",
      1000,
      function () {
        console.log("yellow light");
      },
    ],
  ];

  const start = (lights = [], count = 0) => {
    let length = lights.length;

    return function start() {
      const [light, time, handler] = lights[count % length];

      return setTimeout(() => {
        console.log(`${light}亮`);
        handler && handler(light, time);
        count++;
        start();
      }, time);
    };
  };

  start(LIGHTS)();
})();
```




