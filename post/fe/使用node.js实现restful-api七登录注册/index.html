<!DOCTYPE html>
<html lang="zh-CN"><head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
        name="viewport"
        content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta name="keywords" content="pengjielee,个人博客" />
    <meta name="description" content="Pengjielee的个人博客" />
    <title>Pengjielee&#39;s blog</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700" />
    <link rel="stylesheet" href="/css/style.css" />
</head>
<body><div id="main">
            <nav class="nav">
    <a href="/">首页</a> <span class="divide">|</span>
    <a href="/categories">分类</a>
    <span class="divide">|</span> <a href="/tags">标签</a>
    <span class="divide">|</span>
    <a href="/post">归档</a>
</nav>

    <div class="page-single">
        <header class="header">
            <h1 class="title"></h1><div class="post-meta">
    <div class="date">0001-01-01</div>
</div>
</header>
        <div class="content"><h4 id="实现注册">实现注册</h4>
<p>1、安装依赖</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">npm</span> <span style="color:#a6e22e">install</span> <span style="color:#a6e22e">blueimp</span><span style="color:#f92672">-</span><span style="color:#a6e22e">md5</span> <span style="color:#a6e22e">bcrypt</span>
</span></span></code></pre></div><p>2、修改src/routes/user.js</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>const express <span style="color:#f92672">=</span> require<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;express&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>const <span style="color:#f92672">{</span> header, body <span style="color:#f92672">}</span> <span style="color:#f92672">=</span> require<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;express-validator&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>const router <span style="color:#f92672">=</span> express.Router<span style="color:#f92672">()</span>;
</span></span><span style="display:flex;"><span>const Controller <span style="color:#f92672">=</span> require<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;../controllers/user&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>router.post<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;/register&#39;</span>,
</span></span><span style="display:flex;"><span>  body<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;username&#39;</span><span style="color:#f92672">)</span>.isLength<span style="color:#f92672">({</span> min: <span style="color:#ae81ff">2</span> <span style="color:#f92672">})</span>.withMessage<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;用户名最小长度为2&#39;</span><span style="color:#f92672">)</span>,
</span></span><span style="display:flex;"><span>  body<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;password&#39;</span><span style="color:#f92672">)</span>.isLength<span style="color:#f92672">({</span> min: <span style="color:#ae81ff">6</span> <span style="color:#f92672">})</span>.withMessage<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;密码最小长度为6&#39;</span><span style="color:#f92672">)</span>,
</span></span><span style="display:flex;"><span>  Controller.register
</span></span><span style="display:flex;"><span><span style="color:#f92672">)</span>;
</span></span></code></pre></div><p>3、修改src/controllers/user.js</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">jwt</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;jsonwebtoken&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">bcrypt</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;bcrypt&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">md5</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;blueimp-md5&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">validationResult</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;express-validator&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">User</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;../models/user&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">config</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;../config&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">exports</span>.<span style="color:#a6e22e">register</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//检查提交参数
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">errors</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">validationResult</span>(<span style="color:#a6e22e">req</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>({ <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">message</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">array</span>() });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//获取提交的用户名和密码
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">username</span>, <span style="color:#a6e22e">password</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">body</span>;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//检查数据库中的用户名是否存在
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">dbUser</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">User</span>.<span style="color:#a6e22e">findOne</span>({ <span style="color:#a6e22e">username</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">dbUser</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>({ <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">message</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;用户名已被占用，换一个吧&#34;</span> });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//生成加密盐
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">salt</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">bcrypt</span>.<span style="color:#a6e22e">genSalt</span>(<span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//使用md5加密密码
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encryptPassword</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">md5</span>(<span style="color:#a6e22e">password</span>, <span style="color:#a6e22e">salt</span>);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//保存用户信息
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">newUser</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">User</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">username</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">username</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">password</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">md5Password</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">salt</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">salt</span>, <span style="color:#75715e">//加密盐也保存
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  });
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">newUser</span>.<span style="color:#a6e22e">save</span>();
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">user</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>({ <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">message</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;注册失败&#34;</span> });
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>({ <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">message</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;注册成功&#34;</span>, <span style="color:#a6e22e">data</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">username</span> });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h4 id="实现登录">实现登录</h4>
<p>1、修改src/routes/user.js</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// 用户登录
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">post</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;/login&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">body</span>(<span style="color:#e6db74">&#34;username&#34;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">isLength</span>({ <span style="color:#a6e22e">min</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span> })
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">withMessage</span>(<span style="color:#e6db74">&#34;用户名最小长度为2&#34;</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">body</span>(<span style="color:#e6db74">&#34;password&#34;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">isLength</span>({ <span style="color:#a6e22e">min</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">6</span> })
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">withMessage</span>(<span style="color:#e6db74">&#34;密码最小长度为6&#34;</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Controller</span>.<span style="color:#a6e22e">login</span>
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></div><p>2、修改src/controllers/user.js</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">exports</span>.<span style="color:#a6e22e">login</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//检查提交参数
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">errors</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">validationResult</span>(<span style="color:#a6e22e">req</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>({ <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">errors</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">array</span>() });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//获取提交的用户名和密码
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">username</span>, <span style="color:#a6e22e">password</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">body</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//检查数据库中的用户是否存在
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">dbUser</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">User</span>.<span style="color:#a6e22e">findOne</span>({ <span style="color:#a6e22e">username</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">dbUser</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>({ <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">9999</span>, <span style="color:#a6e22e">message</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;用户不存在&#34;</span> });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//获取数据库中保存的用户信息
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">_id</span>, <span style="color:#a6e22e">password</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">dbPassword</span>, <span style="color:#a6e22e">salt</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">dbUser</span>;
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//对密码进行加密
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encryptPassword</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">md5</span>(<span style="color:#a6e22e">password</span>, <span style="color:#a6e22e">salt</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">isMatch</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">encryptPassword</span> <span style="color:#f92672">===</span> <span style="color:#a6e22e">dbPassword</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">//如果密码正确
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">isMatch</span>) {
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">secret</span>, <span style="color:#a6e22e">expiresIn</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">config</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 生成token，把用户id存入
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">payload</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">userid</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">_id</span> };
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">token</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">sign</span>(<span style="color:#a6e22e">payload</span>, <span style="color:#a6e22e">secret</span>, {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">expiresIn</span>,
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//返回token
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>({ <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">message</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ok&#34;</span>, <span style="color:#a6e22e">data</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">token</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">token</span> } });
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>({ <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">message</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;用户名或密码错误&#34;</span> });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h4 id="测试接口">测试接口</h4>
<p>​</p>
<p>1、注册接口</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">curl</span> <span style="color:#a6e22e">http</span><span style="color:#f92672">:</span><span style="color:#75715e">//localhost:3000/api/user/register -X POST -d &#39;{&#34;username&#34;: &#34;pengjie&#34;,&#34;password&#34;:&#34;123456&#34;}&#39; --header &#34;Content-Type: application/json&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">返回</span><span style="color:#960050;background-color:#1e0010">：</span>
</span></span><span style="display:flex;"><span>{<span style="color:#e6db74">&#34;status&#34;</span><span style="color:#f92672">:</span><span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#34;message&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;注册成功&#34;</span>,<span style="color:#e6db74">&#34;data&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;pengjie&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">curl</span> <span style="color:#a6e22e">http</span><span style="color:#f92672">:</span><span style="color:#75715e">//localhost:3000/api/user/register -X POST -d &#39;{&#34;username&#34;: &#34;pengjie&#34;,&#34;password&#34;:&#34;123456&#34;}&#39; --header &#34;Content-Type: application/json&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">返回</span><span style="color:#960050;background-color:#1e0010">：</span>
</span></span><span style="display:flex;"><span>{<span style="color:#e6db74">&#34;status&#34;</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>,<span style="color:#e6db74">&#34;message&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;用户名已被占用，换一个吧&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">curl</span> <span style="color:#a6e22e">http</span><span style="color:#f92672">:</span><span style="color:#75715e">//localhost:3000/api/user/register -X POST -d &#39;{&#34;username&#34;: &#34;p&#34;,&#34;password&#34;:&#34;1234&#34;}&#39; --header &#34;Content-Type: application/json&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">返回</span><span style="color:#960050;background-color:#1e0010">：</span>
</span></span><span style="display:flex;"><span>{<span style="color:#e6db74">&#34;status&#34;</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>,<span style="color:#e6db74">&#34;message&#34;</span><span style="color:#f92672">:</span>[{<span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;p&#34;</span>,<span style="color:#e6db74">&#34;msg&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;用户名最小长度为2&#34;</span>,<span style="color:#e6db74">&#34;param&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;username&#34;</span>,<span style="color:#e6db74">&#34;location&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;body&#34;</span>},{<span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;1234&#34;</span>,<span style="color:#e6db74">&#34;msg&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;密码最小长度为6&#34;</span>,<span style="color:#e6db74">&#34;param&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;password&#34;</span>,<span style="color:#e6db74">&#34;location&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;body&#34;</span>}]}
</span></span></code></pre></div><p>2、登录接口
​</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">curl</span> <span style="color:#a6e22e">http</span><span style="color:#f92672">:</span><span style="color:#75715e">//localhost:3000/api/user/login -X POST -d &#39;{&#34;username&#34;: &#34;pengjie&#34;,&#34;password&#34;:&#34;123456&#34;}&#39; --header &#34;Content-Type: application/json&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">返回</span><span style="color:#960050;background-color:#1e0010">：</span>
</span></span><span style="display:flex;"><span>{<span style="color:#e6db74">&#34;status&#34;</span><span style="color:#f92672">:</span><span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#34;message&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;ok&#34;</span>,<span style="color:#e6db74">&#34;data&#34;</span><span style="color:#f92672">:</span>{<span style="color:#e6db74">&#34;token&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyaWQiOiI2MTFjNjU1ZTJlNzEzZjQ0ZDExMDA1OGIiLCJpYXQiOjE2MjkyNTEwMzgsImV4cCI6MTYyOTI1ODIzOH0.fu0ztmNIi2yXreTuepl7EBoc5JkYk29h31IGa0EAcmI&#34;</span>}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">curl</span> <span style="color:#a6e22e">http</span><span style="color:#f92672">:</span><span style="color:#75715e">//localhost:3000/api/user/login -X POST -d &#39;{&#34;username&#34;: &#34;pengjie&#34;,&#34;password&#34;:&#34;1234567&#34;}&#39; --header &#34;Content-Type: application/json&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">返回</span><span style="color:#960050;background-color:#1e0010">：</span>
</span></span><span style="display:flex;"><span>{<span style="color:#e6db74">&#34;status&#34;</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>,<span style="color:#e6db74">&#34;message&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;用户名或密码错误&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">curl</span> <span style="color:#a6e22e">http</span><span style="color:#f92672">:</span><span style="color:#75715e">//localhost:3000/api/user/login -X POST -d &#39;{&#34;username&#34;: &#34;p&#34;,&#34;password&#34;:&#34;12345&#34;}&#39; --header &#34;Content-Type: application/json&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">返回</span><span style="color:#960050;background-color:#1e0010">：</span>
</span></span><span style="display:flex;"><span>{<span style="color:#e6db74">&#34;status&#34;</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>,<span style="color:#e6db74">&#34;errors&#34;</span><span style="color:#f92672">:</span>[{<span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;p&#34;</span>,<span style="color:#e6db74">&#34;msg&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;用户名最小长度为2&#34;</span>,<span style="color:#e6db74">&#34;param&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;username&#34;</span>,<span style="color:#e6db74">&#34;location&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;body&#34;</span>},{<span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;12345&#34;</span>,<span style="color:#e6db74">&#34;msg&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;密码最小长度为6&#34;</span>,<span style="color:#e6db74">&#34;param&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;password&#34;</span>,<span style="color:#e6db74">&#34;location&#34;</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;body&#34;</span>}]}
</span></span></code></pre></div></div>
    </div>

        </div></body>
</html>
