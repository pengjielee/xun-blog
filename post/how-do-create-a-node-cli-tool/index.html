<!DOCTYPE html>
<html lang="zh-CN"><head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
        name="viewport"
        content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta name="keywords" content="pengjielee,个人博客" />
    <meta name="description" content="Pengjielee的个人博客" />
    <title>Pengjielee&#39;s blog</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700" />
    <link rel="stylesheet" href="/css/monokai-sublime.min.css" />
    <link rel="stylesheet" href="/css/style.css" />
</head>
<body>
        <div id="main">
            <nav class="nav">
    <a href="/">首页</a> <span class="divide">|</span>
    <a href="/categories">分类</a>
    <span class="divide">|</span> <a href="/tags">标签</a>
    <span class="divide">|</span>
    <a href="/post">归档</a>
</nav>

    <div class="page page-single">
        <header class="header">
            <h1 class="title">如何创建一个Node CLI工具</h1><div class="post-meta">
    <div class="date">2020-10-15</div>
        <div class="tags">
            <label class="label">Tags：</label>
                <a class="link" href="/tags/tool/" rel="tag">Tool</a>
        </div>
</div>
</header>
        <div class="content" id="content"><h2 id="开始">开始</h2>
<p>我们的命令行工具起名xun-cli，实现功能有：</p>
<ul>
<li>显示当前时间；</li>
<li>查询天气；</li>
<li>查看本地IP；</li>
</ul>
<h2 id="创建目录">创建目录</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ mkdir xun-cli
</span></span><span style="display:flex;"><span>$ cd xun-cli 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ npm init -y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ mkdir src 
</span></span><span style="display:flex;"><span>$ cd src
</span></span><span style="display:flex;"><span>$ touch index.js
</span></span></code></pre></div><h2 id="问好">问好</h2>
<p>1、index.js</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env node
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;hello xun-cli&#34;</span>)
</span></span></code></pre></div><p>2、执行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ node src/index.js
</span></span><span style="display:flex;"><span>//output: hello xun-cli
</span></span></code></pre></div><h2 id="输出一个漂亮的logo">输出一个漂亮的LOGO</h2>
<p>1、安装依赖</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ npm install chalk <span style="color:#75715e">#在命令行输出各种颜色的文字</span>
</span></span><span style="display:flex;"><span>$ npm install figlet <span style="color:#75715e">#在命令行输出艺术字</span>
</span></span></code></pre></div><p>2、index.js</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env node
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">chalk</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;chalk&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">figlet</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;figlet&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 输出一个漂亮的LOGO
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">chalk</span>.<span style="color:#a6e22e">yellow</span>(<span style="color:#a6e22e">figlet</span>.<span style="color:#a6e22e">textSync</span>(<span style="color:#e6db74">&#34;xun-CLI&#34;</span>, {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">horizontalLayout</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;full&#34;</span>
</span></span><span style="display:flex;"><span>})));
</span></span></code></pre></div><p>3、执行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ node src/index.js
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>output：
</span></span><span style="display:flex;"><span> __  __  _   _   _   _            ____   _       ___
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">\ \/</span> / | | | | | <span style="color:#ae81ff">\ </span>| |          / ___| | |     |_ _|
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">\ </span> /  | | | | |  <span style="color:#ae81ff">\|</span> |  _____  | |     | |      | |
</span></span><span style="display:flex;"><span>  /  <span style="color:#ae81ff">\ </span> | |_| | | |<span style="color:#ae81ff">\ </span> | |_____| | |___  | |___   | |
</span></span><span style="display:flex;"><span> /_/<span style="color:#ae81ff">\_\ </span> <span style="color:#ae81ff">\_</span>__/  |_| <span style="color:#ae81ff">\_</span>|          <span style="color:#ae81ff">\_</span>___| |_____| |___|
</span></span></code></pre></div><h2 id="显示当前时间">显示当前时间</h2>
<p>1、安装依赖</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ npm install yargs <span style="color:#75715e">#构建可交互的命令行工具</span>
</span></span></code></pre></div><p>2、index.js</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env node
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">yargs</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;yargs&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">yargs</span>.<span style="color:#a6e22e">scriptName</span>(<span style="color:#e6db74">&#34;xun-cli&#34;</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">usage</span>(<span style="color:#e6db74">&#39;$0 &lt;cmd&gt; [args]&#39;</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">command</span>(<span style="color:#e6db74">&#39;date&#39;</span>, <span style="color:#e6db74">&#39;显示当前日期&#39;</span>, (<span style="color:#a6e22e">yargs</span>) =&gt; {}, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">argv</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Current Date: </span><span style="color:#e6db74">${</span><span style="color:#66d9ef">new</span> Date()<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>)
</span></span><span style="display:flex;"><span>  })
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">help</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">argv</span>
</span></span></code></pre></div><p>3、执行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ node src/index.js date
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>//output: Current Date: Fri Oct <span style="color:#ae81ff">16</span> <span style="color:#ae81ff">2020</span> 10:57:51 GMT+0800 <span style="color:#f92672">(</span>China Standard Time<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>4、格式化日期输出</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ npm install dayjs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>const dayjs <span style="color:#f92672">=</span> require<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;dayjs&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>const date <span style="color:#f92672">=</span> dayjs<span style="color:#f92672">()</span>.format<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;YYYY-MM-DD HH:mm:ss&#39;</span><span style="color:#f92672">)</span>;
</span></span></code></pre></div><h2 id="查询天气信息">查询天气信息</h2>
<p>1、安装依赖</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ npm install node-fetch //发起网络请求
</span></span></code></pre></div><p>2、准备天气API，我们使用<a href="https://dev.heweather.com/docs/start/">和风天气</a>API服务：</p>
<p>a. 获取天气信息接口：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">请求</span><span style="color:#960050;background-color:#1e0010">：</span> 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//devapi.heweather.net/v7/weather/now?key=ea27fd16a12c45938ae787b4059fdaba&amp;location=101010100
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">响应</span><span style="color:#960050;background-color:#1e0010">：</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;code&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;200&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;updateTime&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;2020-10-16T11:11+08:00&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;fxLink&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;http://hfx.link/2ax1&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;now&#34;</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;obsTime&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;2020-10-16T10:40+08:00&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;temp&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;14&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;feelsLike&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;11&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;icon&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;100&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;晴&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;wind360&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;6&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;windDir&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;北风&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;windScale&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;3&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;windSpeed&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;12&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;humidity&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;32&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;precip&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;0.0&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;pressure&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;1021&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;vis&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;30&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;cloud&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;91&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;dew&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;-3&#34;</span>
</span></span><span style="display:flex;"><span>	},
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;refer&#34;</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;sources&#34;</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;Weather China&#34;</span>],
</span></span><span style="display:flex;"><span>		<span style="color:#e6db74">&#34;license&#34;</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;no commercial use&#34;</span>]
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>b. 我们只查询几个热门城市</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">hotCity</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;beijing&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;101010100&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;shanghai&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;101020100&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;tianjin&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;101030100&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;hangzhou&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;101210101&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;chengdu&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;101270101&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;zhenzhou&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;101180101&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>c. 和风天气常用地区列表
<a href="https://github.com/qwd/LocationList">https://github.com/qwd/LocationList</a></p>
<p>3、index.js</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fetch</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;node-fetch&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">yargs</span>.<span style="color:#a6e22e">scriptName</span>(<span style="color:#e6db74">&#34;xun-cli&#34;</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">usage</span>(<span style="color:#e6db74">&#39;$0 &lt;cmd&gt; [args]&#39;</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">command</span>(<span style="color:#e6db74">&#39;weather [city]&#39;</span>, <span style="color:#e6db74">&#39;显示天气（默认beijing）&#39;</span>, (<span style="color:#a6e22e">yargs</span>) =&gt; {
</span></span><span style="display:flex;"><span>  	<span style="color:#a6e22e">yargs</span>.<span style="color:#a6e22e">positional</span>(<span style="color:#e6db74">&#39;city&#39;</span>, {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;string&#39;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;beijing&#39;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">describe</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;要查询的城市&#39;</span>
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>  }, <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">argv</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">city</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">argv</span>.<span style="color:#a6e22e">city</span>.<span style="color:#a6e22e">toLowerCase</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">location</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">hotCity</span>[<span style="color:#a6e22e">city</span>] <span style="color:#f92672">?</span> <span style="color:#a6e22e">hotCity</span>[<span style="color:#a6e22e">city</span>] <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;&#39;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">location</span>){
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">`https://devapi.heweather.net/v7/weather/now?key=ea27fd16a12c45938ae787b4059fdaba&amp;location=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">location</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">code</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;200&#39;</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">now</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">now</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">city</span><span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">now</span>.<span style="color:#a6e22e">text</span><span style="color:#e6db74">}</span><span style="color:#e6db74">，</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">now</span>.<span style="color:#a6e22e">temp</span><span style="color:#e6db74">}</span><span style="color:#e6db74">摄氏度，</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">now</span>.<span style="color:#a6e22e">windDir</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>)
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Ops, something error!`</span>)
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">city</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> does not support.`</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  })
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">help</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">argv</span>
</span></span></code></pre></div><p>4、执行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ node src/index.js weather
</span></span><span style="display:flex;"><span>//output: beijing: 晴，14摄氏度，北风
</span></span></code></pre></div><h2 id="查看本地ip">查看本地IP</h2>
<p>1、安装依赖</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ npm install shelljs
</span></span></code></pre></div><p>2、查询本地IP命令</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ifconfig -a|grep inet|grep -v 127.0.0.1|grep -v inet6 | awk <span style="color:#e6db74">&#39;{print $2}&#39;</span> | tr -d <span style="color:#e6db74">&#39;addr:&#39;</span>
</span></span><span style="display:flex;"><span>// 172.18.0.229
</span></span></code></pre></div><p>3、index.js</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">yargs</span>.<span style="color:#a6e22e">scriptName</span>(<span style="color:#e6db74">&#34;xun-cli&#34;</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">usage</span>(<span style="color:#e6db74">&#39;$0 &lt;cmd&gt; [args]&#39;</span>)
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">command</span>(<span style="color:#e6db74">&#39;ip&#39;</span>, <span style="color:#e6db74">&#39;显示本地IP&#39;</span>, (<span style="color:#a6e22e">yargs</span>) =&gt; {
</span></span><span style="display:flex;"><span>  }, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">argv</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ip_address</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">shell</span>.<span style="color:#a6e22e">exec</span>(<span style="color:#e6db74">&#34;ifconfig -a|grep inet|grep -v 127.0.0.1|grep -v inet6 | awk &#39;{print $2}&#39; | tr -d &#39;addr:&#39;&#34;</span>,{<span style="color:#a6e22e">silent</span><span style="color:#f92672">:</span><span style="color:#66d9ef">true</span>}).<span style="color:#a6e22e">stdout</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Local IP: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">ip_address</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>)
</span></span><span style="display:flex;"><span>  })
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">help</span>()
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">argv</span>
</span></span></code></pre></div><p>4、执行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ node src/index.js ip
</span></span><span style="display:flex;"><span>//output: Local IP: 172.18.0.229
</span></span></code></pre></div><h2 id="全局访问脚本">全局访问脚本</h2>
<p>在项目根目录中运行npm link会将符号文件链接到系统路径，从而可以在任何位置访问它。</p>
<p>1、更新package.json</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;bin&#34;</span>: {
</span></span><span style="display:flex;"><span>	  <span style="color:#f92672">&#34;xun-cli&#34;</span>: <span style="color:#e6db74">&#34;src/index.js&#34;</span>
</span></span><span style="display:flex;"><span>	},
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>2、npm link</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cd xun-cli
</span></span><span style="display:flex;"><span>$ npm link
</span></span></code></pre></div><p>3、执行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cd ~
</span></span><span style="display:flex;"><span>$ xun-cli --help
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># xun-cli &lt;cmd&gt; [args]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Commands:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   xun-cli date            显示当前日期</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   xun-cli weather [city]  显示天气（默认beijing）</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   xun-cli ip              显示本地IP</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Options:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   --version  Show version number                                       [boolean]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   --help     Show help</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ xun-cli --version
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1.0.0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ xun-cli date
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Current Date: 2020-10-16 11:32:02</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ xun-cli weather
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Beijing: 晴，14摄氏度，北风</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ xun-cli weather tianjin
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Tianjin: 阴，13摄氏度，北风</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ xun-cli ip
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Local IP: 172.18.0.229</span>
</span></span></code></pre></div><h2 id="项目完整代码">项目完整代码</h2>
<p><a href="https://github.com/pengjielee/xun-cli">xun-cli</a></p>
<h2 id="巨人肩上">巨人肩上</h2>
<p>chalk<br>
<a href="https://github.com/chalk/chalk">https://github.com/chalk/chalk</a></p>
<p>figlet<br>
<a href="https://github.com/patorjk/figlet.js">https://github.com/patorjk/figlet.js</a></p>
<p>yargs  <br>
<a href="https://github.com/yargs/yargs">https://github.com/yargs/yargs</a></p>
<p>node-fetch<br>
<a href="https://github.com/node-fetch/node-fetch">https://github.com/node-fetch/node-fetch</a></p>
<p>dayjs<br>
<a href="https://github.com/iamkun/dayjs">https://github.com/iamkun/dayjs</a></p>
<p>shelljs<br>
<a href="https://github.com/shelljs/shelljs">https://github.com/shelljs/shelljs</a></p>
</div>
        <div class="controls">
            <button id="increase">+</button>
            <button id="decrease">-</button>
        </div>
    </div>

        </div><script src="/js/highlight.min.js"></script>
<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", (event) => {
    		let size = 16;
    		const content = document.querySelector("#content");
        document.querySelectorAll("pre").forEach((block) => {
            hljs.highlightBlock(block);
        });
        document.querySelector("#increase").onclick = function(){
        	size++;
        	content.style.fontSize = `${size}px`;
        }
        document.querySelector("#decrease").onclick = function(){
        	size--;
        	content.style.fontSize = `${size}px`;
        }
    });
</script>
</body>
</html>
